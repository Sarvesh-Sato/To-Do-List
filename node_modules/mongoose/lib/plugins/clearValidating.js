'use strict';

/*!
 * ignore
 */

module.exports = function(schema) {
  // `this.$__.validating` tracks whether there are multiple validations running
  // in parallel. We need to clear `this.$__.validating` before post hooks for gh-8597
  const unshift = true;
  schema.s.hooks.post('validate', false, function() {
<<<<<<< HEAD
    if (this.$__.isSubDocument) {
=======
    if (this.ownerDocument) {
>>>>>>> 632a5a753cb2f274da880e3ab801c61153067d7a
      return;
    }

    this.$__.validating = null;
  }, unshift);

  schema.s.hooks.post('validate', false, function(error, res, next) {
<<<<<<< HEAD
    if (this.$__.isSubDocument) {
=======
    if (this.ownerDocument) {
>>>>>>> 632a5a753cb2f274da880e3ab801c61153067d7a
      next();
      return;
    }

    this.$__.validating = null;
    next();
  }, unshift);
};
